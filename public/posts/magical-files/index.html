<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="KSHITIJ SARAOGI">
<meta name="description" content="Context My Downloads folder is a mess!
I have got hundreds of files in that directory. Most of them are PDF documents with some images, archives and disk images.
‚ÄúIs there a way to only list all the PDF files present in a directory?‚Äù
Well, filtering based on file extension (.pdf) should be able to do this for me. Moreover, I can leverage the power of regular expression: $ ls -lh ~/Downloads/*.">
<meta name="keywords" content="blog,developer,personal,minimal,software,engineer,mathematics">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Magical Files"/>
<meta name="twitter:description" content="Context My Downloads folder is a mess!
I have got hundreds of files in that directory. Most of them are PDF documents with some images, archives and disk images.
‚ÄúIs there a way to only list all the PDF files present in a directory?‚Äù
Well, filtering based on file extension (.pdf) should be able to do this for me. Moreover, I can leverage the power of regular expression: $ ls -lh ~/Downloads/*."/>

<meta property="og:title" content="Magical Files" />
<meta property="og:description" content="Context My Downloads folder is a mess!
I have got hundreds of files in that directory. Most of them are PDF documents with some images, archives and disk images.
‚ÄúIs there a way to only list all the PDF files present in a directory?‚Äù
Well, filtering based on file extension (.pdf) should be able to do this for me. Moreover, I can leverage the power of regular expression: $ ls -lh ~/Downloads/*." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kshitij10496.github.io/posts/magical-files/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-02-10T18:55:02+05:30" />
<meta property="article:modified_time" content="2021-09-04T14:16:29+02:00" />




  <title>kxsh</title>

  
  <link rel="canonical" href="https://kshitij10496.github.io/posts/magical-files/">
  

  <link rel="preload" href="https://kshitij10496.github.io/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="https://kshitij10496.github.io/css/coder.min.6b1a4fbc48955b72aea7913e43fabeb45e8bc120da5aa41b598dd33adcac4b59.css" integrity="sha256-axpPvEiVW3Kup5E&#43;Q/q&#43;tF6LwSDaWqQbWY3TOtysS1k=" crossorigin="anonymous" media="screen" />





  
  
    
    
    <link rel="stylesheet" href="https://kshitij10496.github.io/css/coder-dark.min.39e41a7f16bdf8cb16e43cae7d714fa1016f1d2d2898a5b3f27f42c9979204e2.css" integrity="sha256-OeQafxa9&#43;MsW5DyufXFPoQFvHS0omKWz8n9CyZeSBOI=" crossorigin="anonymous" media="screen" />
  



   




  <link rel="icon" type="image/png" href="https://kshitij10496.github.io/images/favicon_32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://kshitij10496.github.io/images/favicon_16.ico" sizes="16x16">

<link rel="apple-touch-icon" href="https://kshitij10496.github.io/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://kshitij10496.github.io/images/apple-touch-icon.png">

<link rel="manifest" href="https://kshitij10496.github.io/site.webmanifest">
<link rel="mask-icon" href="https://kshitij10496.github.io/images/safari-pinned-tab.svg" color="#5bbad5">


  

  <meta name="generator" content="Hugo 0.101.0" />


  

</head>







<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://kshitij10496.github.io/">
      kxsh
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://kshitij10496.github.io/about/">ABOUT</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://kshitij10496.github.io/now/">NOW</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://kshitij10496.github.io/posts/">POSTS</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://drive.google.com/file/d/1-PqZNNRAuCvtquXWbgvBFEyrTRDwesKV/view?usp=sharing">R√âSUM√â</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://kshitij10496.github.io/index.xml">RSS</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://kshitij10496.github.io/posts/magical-files/">
              Magical Files
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa fa-calendar" aria-hidden="true"></i>
              <time datetime="2019-02-10T18:55:02&#43;05:30">
                February 10, 2019
              </time>
            </span>
            <span class="reading-time">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              3-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa fa-folder" aria-hidden="true"></i>
    <a href="https://kshitij10496.github.io/categories/project/">Project</a>
      <span class="separator">‚Ä¢</span>
    <a href="https://kshitij10496.github.io/categories/software/">Software</a></div>

          <div class="tags">
  <i class="fa fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="https://kshitij10496.github.io/tags/unix/">unix</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="https://kshitij10496.github.io/tags/osx/">osx</a>
    </span>
      <span class="separator">‚Ä¢</span>
    <span class="tag">
      <a href="https://kshitij10496.github.io/tags/linux/">linux</a>
    </span></div>

        </div>
      </header>

      <div>
        
        <h1 id="context">
  Context
  <a class="heading-link" href="#context">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<p>My <code>Downloads</code> folder is a mess!</p>
<p>I have got hundreds of files in that directory. Most of them are PDF documents with some images, archives and disk images.</p>
<p>‚ÄúIs there a way to only list all the PDF files present in a directory?‚Äù</p>
<p>Well, filtering based on file extension (<code>.pdf</code>) should be able to do this for me. Moreover, I can leverage the power of regular expression: <code>$ ls -lh ~/Downloads/*.pdf</code></p>
<p>After some experimentation, I discovered that a non-negligible number of files stored in PDF format existed which did not have a <code>.pdf</code> extension üò±:</p>
<ol>
<li>The university‚Äôs portal only allows us to download PDFs with a <code>.jsp</code> extension. üòì</li>
<li>I had a <code>FileHandler.ashx</code> file that also contained data in PDF format.</li>
</ol>
<p>These findings helped me infer that the use of <code>*.pdf</code> RegEx is not robust enough to ensure that all PDF documents are selected. Apparently, even the OSX‚Äôs Finder fails at detecting the file ‚ÄúKind‚Äù for <code>FileHandler.ashx</code>.</p>
<p>Finder</p>
<p>Looking for something more sophisticated, eh?</p>
<h1 id="detour-magic-numbers-">
  Detour: Magic Numbers ‚ú®
  <a class="heading-link" href="#detour-magic-numbers-">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<p>What is a <strong>magic number</strong>?<br>
Any constant numerical or text value that you find in your code is a magic number, especially the ones you ‚Äúforget‚Äù to comment/document.</p>
<p>Interestingly enough, many files have such constants that identify the contained data. In addition to this, detecting such constants in files is a simple and effective way of distinguishing between many file formats. üò≤ These magic numbers, used to identify or verify the content of a file, are also called ‚Äúfile signatures‚Äù.</p>
<p>Examples:</p>
<ol>
<li>PDF documents begin with <code>%PDF</code> text - the corresponding magic number for this format.</li>
<li>Shebang (<code>!/usr/bin/sh</code>) line in script files is a human readable file signature.</li>
<li><code>&lt;!DOCTYPE HTML&gt;</code> indicate HTML documents.</li>
</ol>
<p><strong>caution ‚ö†Ô∏è:</strong></p>
<p>The magic number approach offers better guarantees that the format will be identified correctly, and can often determine more precise information about the file.</p>
<ol>
<li>Since reasonably reliable ‚Äúmagic number‚Äù tests can be fairly complex, and each file must effectively be tested against every possibility in the magic database, this approach is relatively inefficient, especially for displaying large lists of files.</li>
<li>Also, data must be read from the file itself, increasing latency as opposed to metadata stored in the directory.</li>
<li>Where file types don‚Äôt lend themselves to recognition in this way, the system must fall back to metadata.</li>
</ol>
<p><strong>green light ‚úÖ:</strong></p>
<p>Failing a well-designed magic number test is a pretty sure sign that the file is either <strong>corrupt</strong> or of the <strong>wrong type</strong>. On the other hand, a valid magic number does not guarantee that the file is not corrupt or is of a correct type.</p>
<h1 id="preliminary-research">
  Preliminary Research
  <a class="heading-link" href="#preliminary-research">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<p>I have previously used the Unix <code>file</code> command for determining the file type by performing some ‚Äútests‚Äù via system calls. One of them is the <strong>magic test</strong> which checks the file header for the existence of these magic numbers using the <code>libmagic</code> library written in C.</p>
<p>The next question confronting me: ‚ÄúIs there a way to use the libmagic library from Go?‚Äù</p>
<p>That‚Äôs when I found the <a href="https://github.com/rakyll/magicmime">rakyll/magicmime</a> package from the inimitable JBD. üéâ
It provides Go bindings for the <code>libmagic</code> library - exactly what I was looking for! üòÅ</p>
<h1 id="solution">
  Solution
  <a class="heading-link" href="#solution">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<p>This week I will be developing a CLI using <a href="https://github.com/spf13/cobra">spf13/cobra</a> which can help the users filter files based on it‚Äôs format. My intention is to make a simple, decoupled and UNIX pipe compatible tool that plays well with other utilities. With my university exams starting in 10 days, this week would be the optimal period for me to work on the project.</p>
<p>In case there are any existing solutions for solving this, do let me know!<br>
If you currently experience this problem, I would love to hear your thoughts. üòÉ</p>
<h1 id="references">
  References
  <a class="heading-link" href="#references">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<ol>
<li><a href="https://en.wikipedia.org/wiki/Magic_number_(programming)">Magic number</a></li>
<li><a href="https://en.wikipedia.org/wiki/File_(command)">file command</a></li>
<li><a href="https://en.wikipedia.org/wiki/File_format">File format</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_file_signatures">List of file signatures</a></li>
</ol>

      </div>


      <footer>
        


        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ¬©
    
      2016 -
    
    2022
     KSHITIJ SARAOGI 
    ¬∑
    
    Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
  </section>
</footer>

  </main>

  
  
  <script src="https://kshitij10496.github.io/js/coder.min.236049395dc3682fb2719640872958e12f1f24067bb09c327b233e6290c7edac.js" integrity="sha256-I2BJOV3DaC&#43;ycZZAhylY4S8fJAZ7sJwyeyM&#43;YpDH7aw="></script>
  

  

  

  

  

  

  

  

  

  
</body>

</html>
